---
// Component script
import LinkedInIcon from "../icons/LinkedInIcon.astro";
import Dropdown from "./Dropdown.astro";
import YouTubeIcon from "../icons/YouTubeIcon.astro";

import Image from "astro/components/Image.astro";

import coulsyLogo from "../assets/images/coulsy-logo-sm.jpg";

const menuitems = [
  {
    label: "Our Services",
    link: "/joinery-services",
    items: [
      { label: "Our Joinery Services", link: "/joinery-services" },
      { label: "Bespoke Joinery", link: "/joinery-services/bespoke-joinery" },
      {
        label: "Heritage and Restoration",
        link: "/joinery-services/heritage-restoration-joinery",
      },
      {
        label: "Kitchen Installers",
        link: "/joinery-services/kitchen-installers",
      },
      {
        label: "Accessible Kitchen Installers",
        link: "/joinery-services/accessible-kitchen-installers",
      },
      {
        label: "Sub Contract Joinery",
        link: "/joinery-services/joinery-subcontractors",
      },
      { label: "Door Hanging", link: "/joinery-services/door-hanging" },
      {
        label: "Steel Exit Doors",
        link: "/joinery-services/steel-fire-exit-doors-installers",
      },
      {
        label: "Stud Walls Partitioning",
        link: "/joinery-services/stud-wall-partitioning",
      },
      {
        label: "Truss Roof Installers",
        link: "/joinery-services/truss-roof-installers",
      },
      {
        label: "Traditional Cut Roofs",
        link: "/joinery-services/traditional-cut-roofs",
      },
      {
        label: "Garden Offices and Rooms",
        link: "/joinery-services/garden-offices",
      },
    ],
  },
  {
    label: "About",
    link: "/about",
    items: [
      { label: "About Us", link: "/about" },
      { label: "Compliance", link: "/about/compliance" },
      { label: "Qualifications", link: "/about/qualifications" },
      { label: "Sustainability", link: "/about/sustainability" },
    ],
  },
  {
    label: "Contact",
    link: "/contact",
  },
];
---

<header class="bg-brand text-white relative z-50">
  <div
    class="container mx-auto flex flex-col lg:flex-row items-center justify-between px-4 py-4 lg:py-0"
  >
    <!-- Logo -->
    <div class="relative z-10">
      <a href="/">
        <img
          src="/src/assets/images/coulsy-logo-sm.jpg"
          alt="Coulsy Joinery Logo"
          class="h-24 lg:h-32 -mb-6 lg:-mb-8"
        />

        <Image
          src={coulsyLogo}
          width="100"
          height="100"
          class="object-fit"
          alt="Coulsy Carpentry and joinery"
          loading="lazy"
        />
      </a>
    </div>

    <!-- Desktop Navigation -->
    <nav class="hidden lg:flex items-center space-x-6">
      <ul class="flex items-center gap-4">
        {
          menuitems.map((item) =>
            item.items ? (
              <li>
                <Dropdown label={item.label} items={item.items} />
              </li>
            ) : (
              <li>
                <a
                  href={item.link}
                  class="text-white hover:text-gray-200 px-2 py-2"
                >
                  {item.label}
                </a>
              </li>
            )
          )
        }
      </ul>
    </nav>

    <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" class="block lg:hidden ml-auto mt-2">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 448 512"
        class="w-6 h-6 text-white"
      >
        <path
          d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"
        ></path>
      </svg>
    </button>

    <!-- Social Icons -->
    <div class="hidden lg:flex items-center gap-4 ml-auto">
      <a
        href="https://www.linkedin.com/company/coulsy-limited/?viewAsMember=true"
        target="_blank"
        rel="noopener"
        aria-label="LinkedIn"
      >
        <LinkedInIcon className="h-8 w-8 fill-white" />
      </a>
      <a
        target="_blank"
        rel="noopener"
        class="nav-link"
        href="https://www.youtube.com/@coulsyjoinery"
        aria-label="YouTube icon link"
      >
        <YouTubeIcon className="h-8 w-8 fill-white" />
      </a>
      <!-- Add more icons if needed -->
    </div>
  </div>

  <!-- Mobile Menu -->
  <nav
    id="mobile-nav-menu"
    class="hidden flex-col w-full items-center bg-brand-light"
  >
    <ul class="flex flex-col w-full my-2">
      {
        menuitems.map((item) => (
          <li class="flex flex-col items-center group">
            {item.items ? (
              <>
                <button class="flex px-4 py-4 text-white hover:text-gray-200 text-xl justify-center items-center">
                  {item.label}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="3"
                    stroke="currentColor"
                    class="w-3 h-3 ml-2 transition-transform group-[.is-open]:rotate-180"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                    />
                  </svg>
                </button>
                <ul class="hidden group-[.is-open]:flex flex-col w-full bg-brand-lighter">
                  {item.items.map((subitem) => (
                    <li>
                      <a
                        href={subitem.link}
                        class="px-4 py-4 text-white text-center hover:text-gray-200"
                      >
                        {subitem.label}
                      </a>
                    </li>
                  ))}
                </ul>
              </>
            ) : (
              <a
                href={item.link}
                class="px-4 py-4 text-white text-center hover:text-gray-200 text-xl"
              >
                {item.label}
              </a>
            )}
          </li>
        ))
      }
    </ul>
  </nav>
</header>

<script>
  const toggle = document.getElementById("mobile-nav-toggle");
  const menu = document.getElementById("mobile-nav-menu");
  const dropdowns = menu?.querySelectorAll("button");

  toggle?.addEventListener("click", () => {
    menu?.classList.toggle("hidden");
    menu?.classList.toggle("flex");
  });

  dropdowns?.forEach((dropdown) => {
    dropdown.addEventListener("click", () => {
      const group = dropdown.closest("li");
      group?.classList.toggle("is-open");
    });
  });
</script>
